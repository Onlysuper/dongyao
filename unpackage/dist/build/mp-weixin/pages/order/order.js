(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"37e6":function(t,e,s){"use strict";var i=s("565e"),a=s.n(i);a.a},"4cff":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"m-pay-page"},[s("view",{staticClass:"m-top-back"}),s("view",{staticClass:"m-top-map"},[s("view",{staticClass:"m-container"},[1==t.state?s("view",{staticClass:"m-content"},[s("view",{staticClass:"m-title"},[t._v(t._s(t.order.carryCode))]),s("view",{staticClass:"m-describe"},[t._v("请在取货时出示提示码")])]):2==t.state?s("view",{staticClass:"m-content waitepay"},[s("view",{staticClass:"m-title"},[t._v("待支付")]),s("view",{staticClass:"m-describe"},[t._v("支付成功后显示提货码")])]):3==t.state?s("view",{staticClass:"m-content"},[s("view",{staticClass:"m-title"},[t._v("已完成交易")]),s("view",{staticClass:"m-describe"},[t._v("感谢您对东尧蔬菜的信任")])]):t._e()])]),s("view",{staticClass:"m-store-box"},[s("view",{staticClass:"m-name"},[s("view",{staticClass:"m-body"},[t._v(t._s(t.store.name))]),s("view",{staticClass:"m-phone",attrs:{eventid:"69f9dad0-0"},on:{tap:function(e){t.callPhone(t.store.tel)}}},[s("image",{staticStyle:{width:"40rpx",height:"40rpx","margin-left":"20rpx"},attrs:{src:"../../static/img/icon/shop_icon_phone.png",mode:"aspectFit"}})])]),s("view",{staticClass:"address"},[t._v(t._s(t.store.address))]),3==t.state?s("view",{staticClass:"m-time"},[t._v("提货时间："+t._s(t.store.actualPickingTime))]):s("view",{staticClass:"m-time"},[t._v("提货时间："+t._s(t.store.aboutPickingTime))])]),s("view",{staticClass:"m-pro-container"},[t._l(t.productList,function(t,e){return s("m-order-pro",{key:t.id,attrs:{title:t.synopsis,price:t.presentPrice,oldprice:t.originalPrice,imgurl:t.pictureUrl,num:t.buyCount,mpcomid:"69f9dad0-0-"+e}})}),s("view",{staticClass:"m-footer"},[t._v("合计"),s("view",{staticClass:"count"},[t._v("￥"+t._s(t.order.totalPrice))])])],2),s("view",{staticClass:"m-order-detail"},[s("view",{staticClass:"m-title"},[t._v("订单信息")]),s("view",{staticClass:"m-item"},[t._v("订单编号："+t._s(t.order.id))]),s("view",{staticClass:"m-item"},[t._v("支付方式：微信支付")]),s("view",{staticClass:"m-item"},[t._v("下单时间："+t._s(t.order.createTime))])]),s("view",{staticClass:"place"}),2==t.state?s("view",{staticClass:"m-footer-but",attrs:{eventid:"69f9dad0-1"},on:{click:t.payFn}},[t._v("立即支付￥"+t._s(t.order.totalPrice))]):t._e()])},a=[];s.d(e,"a",function(){return i}),s.d(e,"b",function(){return a})},"514d":function(t,e,s){"use strict";s.r(e);var i=s("4cff"),a=s("fe73");for(var o in a)"default"!==o&&function(t){s.d(e,t,function(){return a[t]})}(o);s("37e6");var r=s("2877"),n=Object(r["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=n.exports},"565e":function(t,e,s){},"929d":function(t,e,s){"use strict";s("ba95");var i=o(s("b0ce")),a=o(s("514d"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(a.default))},d0d6:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(s("df44")),a=o(s("ecb9"));function o(t){return t&&t.__esModule?t:{default:t}}function r(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{},i=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable}))),i.forEach(function(e){n(t,e,s[e])})}return t}function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c={components:{mMap:i.default,mOrderPro:a.default},data:function(){return{order:{},productList:[],store:{},state:"",orderid:"",paytype:"",latitude:39.909,longitude:116.39742}},methods:{getLocation:function(){t.getLocation({type:"wgs84",success:function(t){console.log("当前位置的经度："+t.longitude),console.log("当前位置的纬度："+t.latitude)}})},getOrder:function(){var t=this,e=this,s=e.orderid||"";this.mPost("/server/o/orderDetail",s).then(function(e){var s=e.data;t.order=s.order,t.productList=s.productList,t.store=s.store,t.state=t.order.state}).catch(function(t){console.log(t)})},payFn:function(){var e=this,s=e.productList.map(function(t){return{productId:t.id,cou:t.buyCount}}),i={storeId:e.store.storeid,totalCount:e.order.discount,type:e.order.is_assemble,couponId:e.order.couponId,products:s,aboutPickingTime:e.store.aboutPickingTime,outTradeNo:e.order.id,reserveTel:e.order.reserveTel};e.mPost("/server/pay/wxpay",i).then(function(s){if(1==s.code){var i=s.data,a=(i.prepay_id,{provider:"wxpay",timeStamp:i.timeStamp+"",nonceStr:i.nonceStr,package:i.package,signType:i.signType,paySign:i.paySign});t.requestPayment(r({},a,{success:function(e){t.showModal({title:"支付成功",content:"可在我的订单中查看订单详情",confirmText:"查看订单",success:function(e){e.confirm?t.switchTab({url:"/pages/tabBar/order"}):e.cancel&&console.log("用户点击取消")}})},fail:function(s){t.showModal({title:"支付失败",content:"请您在重新尝试一下支付",confirmText:"重新支付",success:function(t){t.confirm?e.payFn():t.cancel&&console.log("用户点击取消")}})}}))}})}},onLoad:function(t){this.orderid=t.orderid,this.getLocation(),this.getOrder()},onShow:function(){t.setStorageSync("orderTab",4)},onUnload:function(){var e=4;1!=this.state&&2!=this.state&&3!=this.state||(e=this.state),t.setStorageSync("orderTab",e)}};e.default=c}).call(this,s("543d")["default"])},fe73:function(t,e,s){"use strict";s.r(e);var i=s("d0d6"),a=s.n(i);for(var o in i)"default"!==o&&function(t){s.d(e,t,function(){return i[t]})}(o);e["default"]=a.a}},[["929d","common/runtime","common/vendor"]]]);